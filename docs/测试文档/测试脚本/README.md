# 测试脚本说明

本目录包含应用内更新系统的所有自动化测试脚本，用于验证系统功能的正确性。

## 📁 脚本分类

### 🔧 综合测试脚本

#### 1. 综合接口测试.sh
- **功能**: 完整的端到端测试，包含管理端和移动端所有API接口
- **测试范围**: 
  - 管理端API（查询、修改、统计）
  - 移动端API（检查更新、下载）
  - 参数验证和错误处理
- **适用场景**: 完整功能验证、回归测试
- **执行时间**: 约2-3分钟

#### 2. 快速测试.sh
- **功能**: 快速验证系统核心功能
- **测试范围**: 基本的更新检查和文件下载功能
- **适用场景**: 快速验证、开发过程中的功能检查
- **执行时间**: 约30-60秒

### 🔐 安全认证测试

#### 3. 认证功能测试.sh
- **功能**: 测试API认证机制
- **测试范围**:
  - 移动端API无需认证访问
  - 管理端API需要API密钥认证
  - 错误API密钥被正确拒绝
  - 缺少API密钥被正确拒绝
- **适用场景**: 安全功能验证、权限控制测试
- **执行时间**: 约30秒

### 📱 移动端测试

#### 4. 移动端接口测试.sh
- **功能**: 专门测试移动端相关的API接口
- **测试范围**:
  - 检查更新接口（无更新、有更新、错误情况）
  - 参数验证（缺少必填参数）
  - APK文件下载功能
- **适用场景**: 移动端集成验证、SDK功能测试
- **执行时间**: 约1分钟

### 🛠️ 管理端测试

#### 5. 管理端接口测试.sh
- **功能**: 测试所有管理端API接口的基本功能
- **测试范围**:
  - 查询应用列表、版本列表
  - 修改版本信息和状态
  - 删除操作（单个和批量）
  - 错误处理和参数验证
- **适用场景**: 管理后台功能验证
- **执行时间**: 约2分钟

#### 6. 管理端接口综合测试.sh
- **功能**: 最终版本的管理端API综合测试
- **测试范围**: 
  - 包含所有管理端API的完整测试流程
  - 状态变更验证
  - 错误边界测试
- **适用场景**: 管理端功能的深度测试
- **执行时间**: 约2分钟

#### 7. 应用列表接口测试.sh
- **功能**: 专门测试应用列表查询API
- **测试范围**:
  - 分页查询功能
  - 搜索功能（中文应用名）
  - 排序功能
  - 安全认证验证
- **适用场景**: 应用管理功能验证
- **执行时间**: 约1分钟

#### 8. 应用版本接口测试.sh
- **功能**: 专门测试应用版本列表查询API
- **测试范围**:
  - 根据应用ID查询版本列表
  - 分页和排序功能
  - 错误处理（不存在的应用）
  - 安全认证验证
- **适用场景**: 版本管理功能验证
- **执行时间**: 约1分钟

## 🚀 使用方法

### 环境要求
- 服务器已启动（http://localhost:8080）
- 已安装 `curl` 和 `jq` 工具
- API密钥配置正确（默认: "your-secret-api-key"）

### 执行步骤
1. 启动服务器
   ```bash
   cd Server && mvn spring-boot:run
   ```

2. 执行测试脚本
   ```bash
   cd docs/测试文档/测试脚本/
   ./综合接口测试.sh
   ```

### 推荐测试顺序
1. **首次验证**: `认证功能测试.sh` → `快速测试.sh`
2. **功能开发**: `移动端接口测试.sh` → `管理端接口测试.sh`
3. **完整验证**: `综合接口测试.sh`
4. **特定功能**: 根据需要选择对应的专项测试脚本

## 📋 测试结果说明

### 成功标识
- ✅ 绿色勾号表示测试通过
- HTTP 200 状态码表示请求成功
- 正确的JSON响应结构

### 失败标识
- ❌ 红色叉号表示测试失败
- HTTP 4xx/5xx 状态码表示请求失败
- 错误的响应内容或格式

### 安全测试
- HTTP 401：未授权（缺少API密钥）
- HTTP 403：禁止访问（错误的API密钥）

## 🔍 故障排除

### 常见问题
1. **服务器未启动**: 确保Spring Boot应用正在运行
2. **API密钥错误**: 检查环境变量或配置文件中的API密钥
3. **端口占用**: 确认8080端口可用
4. **依赖缺失**: 安装curl和jq工具

### 调试技巧
- 使用 `bash -x 脚本名.sh` 查看详细执行过程
- 检查服务器日志了解错误详情
- 手动执行单个curl命令验证问题

## 📈 测试覆盖范围

| 功能模块 | 覆盖率 | 测试脚本 |
|---------|--------|----------|
| 移动端API | 100% | 移动端接口测试.sh |
| 管理端查询API | 100% | 应用列表接口测试.sh, 应用版本接口测试.sh |
| 管理端修改API | 100% | 管理端接口测试.sh |
| 认证机制 | 100% | 认证功能测试.sh |
| 文件下载 | 100% | 移动端接口测试.sh |
| 错误处理 | 90% | 各专项测试脚本 |

---

💡 **提示**: 建议在每次代码变更后执行相关测试脚本，确保功能正常工作。 